import torch
from torch.utils.data import Dataset
import json, os

S_MASK = 1
O_MASK = 2

import torch
from torch.nn.utils.rnn import pad_sequence

class PadSequenceCDRDataset():
    """
    collate_fn for dataloader to collate sequences of different lengths into a fixed length batch
    Returns padded x sequence, y sequence, x lengths and y lengths of batch
    """

    def __init__(self, token_pad_value, masked_entities_pad_value=0):
        self.token_pad_value = token_pad_value
        self.masked_entities_pad_value = masked_entities_pad_value

    def __call__(self, batch):
        seqs = [x[0] for x in batch]
        seqs = pad_sequence(seqs, batch_first=True, padding_value=self.token_pad_value)
        masked_entities_encoded_seqs = [x[1] for x in batch]
        masked_entities_encoded_seqs = pad_sequence(masked_entities_encoded_seqs, batch_first=True, padding_value=self.masked_entities_pad_value)
        chemical_code_seqs = torch.stack(list(map(lambda x: x[2], batch)))
        disease_code_seqs = torch.stack(list(map(lambda x: x[3], batch)))
        labels = torch.stack(list(map(lambda x: x[4], batch)))
        output = [seqs, masked_entities_encoded_seqs, chemical_code_seqs, disease_code_seqs, labels]
        # label = torch.stack(list(map(lambda x: x[4], batch)))
        return output

class CDRDataset(Dataset):
    def __init__(self, samples, label_dict):
        self.samples = samples
        self.label_dict = label_dict

    # [[{'inter_index': '1', 'text': 'naloxone', 'governor': 2, 'dependency_relation': 'nsubj', 'origin_pos': 0, 'ner_label': 'B-Chemical', 'code': 'D009270', 'is_e2': False, 'is_e1': False}, {'inter_index': '2', 'text': 'reverses', 'governor': 0, 'dependency_relation': 'root', 'origin_pos': 9, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '3', 'text': 'the', 'governor': 5, 'dependency_relation': 'det', 'origin_pos': 18, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '4', 'text': 'antihypertensive', 'governor': 5, 'dependency_relation': 'amod', 'origin_pos': 22, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '5', 'text': 'effect', 'governor': 2, 'dependency_relation': 'obj', 'origin_pos': 39, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '6', 'text': 'of', 'governor': 7, 'dependency_relation': 'case', 'origin_pos': 46, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '7', 'text': 'clonidine', 'governor': 5, 'dependency_relation': 'nmod', 'origin_pos': 49, 'ner_label': 'B-Chemical', 'code': 'D003000', 'is_e2': False, 'is_e1': False}, {'inter_index': '8', 'text': '.', 'governor': 2, 'dependency_relation': 'punct', 'origin_pos': 58, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}], [{'inter_index': '1', 'text': 'in', 'governor': 2, 'dependency_relation': 'case', 'origin_pos': 60, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '2', 'text': 'unanesthetized', 'governor': 28, 'dependency_relation': 'obl', 'origin_pos': 63, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '3', 'text': ',', 'governor': 28, 'dependency_relation': 'punct', 'origin_pos': 77, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '4', 'text': 'spontaneously', 'governor': 6, 'dependency_relation': 'advmod', 'origin_pos': 79, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '5', 'text': 'hypertensive', 'governor': 6, 'dependency_relation': 'amod', 'origin_pos': 93, 'ner_label': 'B-Disease', 'code': 'D006973', 'is_e2': False, 'is_e1': False}, {'inter_index': '6', 'text': 'rats', 'governor': 28, 'dependency_relation': 'nsubj:pass', 'origin_pos': 106, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '7', 'text': 'the', 'governor': 8, 'dependency_relation': 'det', 'origin_pos': 111, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '8', 'text': 'decrease', 'governor': 6, 'dependency_relation': 'appos', 'origin_pos': 115, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '9', 'text': 'in', 'governor': 11, 'dependency_relation': 'case', 'origin_pos': 124, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '10', 'text': 'blood', 'governor': 11, 'dependency_relation': 'compound', 'origin_pos': 127, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '11', 'text': 'pressure', 'governor': 8, 'dependency_relation': 'nmod', 'origin_pos': 133, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '12', 'text': 'and', 'governor': 14, 'dependency_relation': 'cc', 'origin_pos': 142, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '13', 'text': 'heart', 'governor': 14, 'dependency_relation': 'compound', 'origin_pos': 146, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '14', 'text': 'rate', 'governor': 11, 'dependency_relation': 'conj', 'origin_pos': 152, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '15', 'text': 'produced', 'governor': 14, 'dependency_relation': 'acl', 'origin_pos': 157, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '16', 'text': 'by', 'governor': 18, 'dependency_relation': 'case', 'origin_pos': 166, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '17', 'text': 'intravenous', 'governor': 18, 'dependency_relation': 'amod', 'origin_pos': 169, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '18', 'text': 'clonidine', 'governor': 15, 'dependency_relation': 'obl', 'origin_pos': 181, 'ner_label': 'B-Chemical', 'code': 'D003000', 'is_e2': False, 'is_e1': False}, {'inter_index': '19', 'text': ',', 'governor': 23, 'dependency_relation': 'punct', 'origin_pos': 190, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '20', 'text': '5', 'governor': 23, 'dependency_relation': 'nummod', 'origin_pos': 192, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '21', 'text': 'to', 'governor': 22, 'dependency_relation': 'case', 'origin_pos': 194, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '22', 'text': '20', 'governor': 20, 'dependency_relation': 'nmod', 'origin_pos': 197, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '23', 'text': 'micrograms', 'governor': 18, 'dependency_relation': 'appos', 'origin_pos': 200, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '24', 'text': '/', 'governor': 25, 'dependency_relation': 'cc', 'origin_pos': 210, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '25', 'text': 'kg', 'governor': 23, 'dependency_relation': 'conj', 'origin_pos': 211, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '26', 'text': ',', 'governor': 28, 'dependency_relation': 'punct', 'origin_pos': 213, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '27', 'text': 'was', 'governor': 28, 'dependency_relation': 'aux:pass', 'origin_pos': 215, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '28', 'text': 'inhibited', 'governor': 0, 'dependency_relation': 'root', 'origin_pos': 219, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '29', 'text': 'or', 'governor': 30, 'dependency_relation': 'cc', 'origin_pos': 229, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '30', 'text': 'reversed', 'governor': 28, 'dependency_relation': 'conj', 'origin_pos': 232, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '31', 'text': 'by', 'governor': 32, 'dependency_relation': 'case', 'origin_pos': 241, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '32', 'text': 'nalozone', 'governor': 28, 'dependency_relation': 'obl', 'origin_pos': 244, 'ner_label': 'B-Chemical', 'code': '-1', 'is_e2': False, 'is_e1': False}, {'inter_index': '33', 'text': ',', 'governor': 32, 'dependency_relation': 'punct', 'origin_pos': 252, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '34', 'text': '0.2', 'governor': 37, 'dependency_relation': 'nummod', 'origin_pos': 254, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '35', 'text': 'to', 'governor': 36, 'dependency_relation': 'case', 'origin_pos': 258, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '36', 'text': '2', 'governor': 34, 'dependency_relation': 'nmod', 'origin_pos': 261, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '37', 'text': 'mg', 'governor': 39, 'dependency_relation': 'compound', 'origin_pos': 263, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '38', 'text': '/', 'governor': 39, 'dependency_relation': 'cc', 'origin_pos': 265, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '39', 'text': 'kg', 'governor': 32, 'dependency_relation': 'appos', 'origin_pos': 266, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '40', 'text': '.', 'governor': 28, 'dependency_relation': 'punct', 'origin_pos': 268, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '41', 'text': 'the', 'governor': 43, 'dependency_relation': 'det', 'origin_pos': 270, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '42', 'text': 'hypotensive', 'governor': 43, 'dependency_relation': 'amod', 'origin_pos': 274, 'ner_label': 'B-Disease', 'code': 'D007022', 'is_e2': True, 'is_e1': False}, {'inter_index': '43', 'text': 'effect', 'governor': 53, 'dependency_relation': 'nsubj:pass', 'origin_pos': 286, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '44', 'text': 'of', 'governor': 49, 'dependency_relation': 'case', 'origin_pos': 293, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '45', 'text': '100', 'governor': 49, 'dependency_relation': 'nummod', 'origin_pos': 296, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '46', 'text': 'mg', 'governor': 49, 'dependency_relation': 'compound', 'origin_pos': 300, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '47', 'text': '/', 'governor': 48, 'dependency_relation': 'punct', 'origin_pos': 302, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '48', 'text': 'kg', 'governor': 49, 'dependency_relation': 'compound', 'origin_pos': 303, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '49', 'text': 'alpha-methyldopa', 'governor': 43, 'dependency_relation': 'nmod', 'origin_pos': 306, 'ner_label': 'B-Chemical', 'code': 'D008750', 'is_e1': True, 'is_e2': False}, {'inter_index': '50', 'text': 'was', 'governor': 53, 'dependency_relation': 'aux:pass', 'origin_pos': 323, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '51', 'text': 'also', 'governor': 53, 'dependency_relation': 'advmod', 'origin_pos': 327, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '52', 'text': 'partially', 'governor': 53, 'dependency_relation': 'advmod', 'origin_pos': 332, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '53', 'text': 'reversed', 'governor': 28, 'dependency_relation': 'conj', 'origin_pos': 342, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '54', 'text': 'by', 'governor': 55, 'dependency_relation': 'case', 'origin_pos': 351, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '55', 'text': 'naloxone', 'governor': 53, 'dependency_relation': 'obl', 'origin_pos': 354, 'ner_label': 'B-Chemical', 'code': 'D009270', 'is_e2': False, 'is_e1': False}, {'inter_index': '56', 'text': '.', 'governor': 28, 'dependency_relation': 'punct', 'origin_pos': 362, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}], [{'inter_index': '1', 'text': 'naloxone', 'governor': 5, 'dependency_relation': 'nsubj', 'origin_pos': 364, 'ner_label': 'B-Chemical', 'code': 'D009270', 'is_e2': False, 'is_e1': False}, {'inter_index': '2', 'text': 'alone', 'governor': 1, 'dependency_relation': 'advmod', 'origin_pos': 373, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '3', 'text': 'did', 'governor': 5, 'dependency_relation': 'aux', 'origin_pos': 379, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '4', 'text': 'not', 'governor': 5, 'dependency_relation': 'advmod', 'origin_pos': 383, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '5', 'text': 'affect', 'governor': 0, 'dependency_relation': 'root', 'origin_pos': 387, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '6', 'text': 'either', 'governor': 8, 'dependency_relation': 'cc:preconj', 'origin_pos': 394, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '7', 'text': 'blood', 'governor': 8, 'dependency_relation': 'compound', 'origin_pos': 401, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '8', 'text': 'pressure', 'governor': 5, 'dependency_relation': 'obj', 'origin_pos': 407, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '9', 'text': 'or', 'governor': 11, 'dependency_relation': 'cc', 'origin_pos': 416, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '10', 'text': 'heart', 'governor': 11, 'dependency_relation': 'compound', 'origin_pos': 419, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '11', 'text': 'rate', 'governor': 8, 'dependency_relation': 'conj', 'origin_pos': 425, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '12', 'text': '.', 'governor': 5, 'dependency_relation': 'punct', 'origin_pos': 429, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}], [{'inter_index': '1', 'text': 'in', 'governor': 3, 'dependency_relation': 'case', 'origin_pos': 431, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '2', 'text': 'brain', 'governor': 3, 'dependency_relation': 'compound', 'origin_pos': 434, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '3', 'text': 'membranes', 'governor': 25, 'dependency_relation': 'obl', 'origin_pos': 440, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '4', 'text': 'from', 'governor': 7, 'dependency_relation': 'case', 'origin_pos': 450, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '5', 'text': 'spontaneously', 'governor': 6, 'dependency_relation': 'advmod', 'origin_pos': 455, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '6', 'text': 'hypertensive', 'governor': 7, 'dependency_relation': 'amod', 'origin_pos': 469, 'ner_label': 'B-Disease', 'code': 'D006973', 'is_e2': False, 'is_e1': False}, {'inter_index': '7', 'text': 'rats', 'governor': 3, 'dependency_relation': 'nmod', 'origin_pos': 482, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '8', 'text': 'clonidine', 'governor': 7, 'dependency_relation': 'appos', 'origin_pos': 487, 'ner_label': 'B-Chemical', 'code': 'D003000', 'is_e2': False, 'is_e1': False}, {'inter_index': '9', 'text': ',', 'governor': 8, 'dependency_relation': 'punct', 'origin_pos': 496, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '10', 'text': '10', 'governor': 8, 'dependency_relation': 'nummod', 'origin_pos': 498, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '11', 'text': '(', 'governor': 10, 'dependency_relation': 'punct', 'origin_pos': 500, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '12', 'text': '-', 'governor': 13, 'dependency_relation': 'case', 'origin_pos': 501, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '13', 'text': '8', 'governor': 10, 'dependency_relation': 'nmod', 'origin_pos': 502, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '14', 'text': ')', 'governor': 10, 'dependency_relation': 'punct', 'origin_pos': 503, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '15', 'text': 'to', 'governor': 21, 'dependency_relation': 'case', 'origin_pos': 505, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '16', 'text': '10', 'governor': 21, 'dependency_relation': 'nummod', 'origin_pos': 508, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '17', 'text': '(', 'governor': 21, 'dependency_relation': 'punct', 'origin_pos': 510, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '18', 'text': '-', 'governor': 19, 'dependency_relation': 'case', 'origin_pos': 511, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '19', 'text': '5', 'governor': 16, 'dependency_relation': 'nmod', 'origin_pos': 512, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '20', 'text': ')', 'governor': 21, 'dependency_relation': 'punct', 'origin_pos': 513, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '21', 'text': 'm', 'governor': 25, 'dependency_relation': 'obl', 'origin_pos': 515, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '22', 'text': ',', 'governor': 25, 'dependency_relation': 'punct', 'origin_pos': 516, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '23', 'text': 'did', 'governor': 25, 'dependency_relation': 'aux', 'origin_pos': 518, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '24', 'text': 'not', 'governor': 25, 'dependency_relation': 'advmod', 'origin_pos': 522, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '25', 'text': 'influence', 'governor': 0, 'dependency_relation': 'root', 'origin_pos': 526, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '26', 'text': 'stereoselective', 'governor': 27, 'dependency_relation': 'compound', 'origin_pos': 536, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '27', 'text': 'binding', 'governor': 25, 'dependency_relation': 'obj', 'origin_pos': 552, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '28', 'text': 'of', 'governor': 31, 'dependency_relation': 'case', 'origin_pos': 560, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '29', 'text': '[', 'governor': 31, 'dependency_relation': 'punct', 'origin_pos': 563, 'ner_label': 'B-Chemical', 'code': '-1', 'is_e2': False, 'is_e1': False}, {'inter_index': '30', 'text': '3', 'governor': 31, 'dependency_relation': 'nummod', 'origin_pos': 564, 'ner_label': 'I-Chemical', 'code': '-1', 'is_e2': False, 'is_e1': False}, {'inter_index': '31', 'text': 'h', 'governor': 27, 'dependency_relation': 'nmod', 'origin_pos': 565, 'ner_label': 'I-Chemical', 'code': '-1', 'is_e2': False, 'is_e1': False}, {'inter_index': '32', 'text': ']', 'governor': 31, 'dependency_relation': 'punct', 'origin_pos': 566, 'ner_label': 'I-Chemical', 'code': '-1', 'is_e2': False, 'is_e1': False}, {'inter_index': '33', 'text': '-', 'governor': 27, 'dependency_relation': 'punct', 'origin_pos': 567, 'ner_label': 'I-Chemical', 'code': '-1', 'is_e2': False, 'is_e1': False}, {'inter_index': '34', 'text': 'naloxone', 'governor': 27, 'dependency_relation': 'appos', 'origin_pos': 568, 'ner_label': 'I-Chemical', 'code': '-1', 'is_e2': False, 'is_e1': False}, {'inter_index': '35', 'text': '(', 'governor': 37, 'dependency_relation': 'punct', 'origin_pos': 577, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '36', 'text': '8', 'governor': 37, 'dependency_relation': 'nummod', 'origin_pos': 578, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '37', 'text': 'nm', 'governor': 34, 'dependency_relation': 'appos', 'origin_pos': 580, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '38', 'text': ')', 'governor': 37, 'dependency_relation': 'punct', 'origin_pos': 582, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '39', 'text': ',', 'governor': 41, 'dependency_relation': 'punct', 'origin_pos': 583, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '40', 'text': 'and', 'governor': 41, 'dependency_relation': 'cc', 'origin_pos': 585, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '41', 'text': 'naloxone', 'governor': 34, 'dependency_relation': 'conj', 'origin_pos': 589, 'ner_label': 'B-Chemical', 'code': 'D009270', 'is_e2': False, 'is_e1': False}, {'inter_index': '42', 'text': ',', 'governor': 41, 'dependency_relation': 'punct', 'origin_pos': 597, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '43', 'text': '10', 'governor': 41, 'dependency_relation': 'nummod', 'origin_pos': 599, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '44', 'text': '(', 'governor': 43, 'dependency_relation': 'punct', 'origin_pos': 601, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '45', 'text': '-', 'governor': 46, 'dependency_relation': 'case', 'origin_pos': 602, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '46', 'text': '8', 'governor': 43, 'dependency_relation': 'nmod', 'origin_pos': 603, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '47', 'text': ')', 'governor': 43, 'dependency_relation': 'punct', 'origin_pos': 604, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '48', 'text': 'to', 'governor': 54, 'dependency_relation': 'case', 'origin_pos': 606, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '49', 'text': '10', 'governor': 54, 'dependency_relation': 'nummod', 'origin_pos': 609, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '50', 'text': '(', 'governor': 54, 'dependency_relation': 'punct', 'origin_pos': 611, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '51', 'text': '-', 'governor': 52, 'dependency_relation': 'case', 'origin_pos': 612, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '52', 'text': '4', 'governor': 49, 'dependency_relation': 'nmod', 'origin_pos': 613, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '53', 'text': ')', 'governor': 52, 'dependency_relation': 'punct', 'origin_pos': 614, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '54', 'text': 'm', 'governor': 58, 'dependency_relation': 'obl', 'origin_pos': 616, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '55', 'text': ',', 'governor': 58, 'dependency_relation': 'punct', 'origin_pos': 617, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '56', 'text': 'did', 'governor': 58, 'dependency_relation': 'aux', 'origin_pos': 619, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '57', 'text': 'not', 'governor': 58, 'dependency_relation': 'advmod', 'origin_pos': 623, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '58', 'text': 'influence', 'governor': 25, 'dependency_relation': 'parataxis', 'origin_pos': 627, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '59', 'text': 'clonidine', 'governor': 61, 'dependency_relation': 'compound', 'origin_pos': 637, 'ner_label': 'B-Chemical', 'code': 'D003000', 'is_e2': False, 'is_e1': False}, {'inter_index': '60', 'text': '-', 'governor': 61, 'dependency_relation': 'punct', 'origin_pos': 646, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '61', 'text': 'suppressible', 'governor': 62, 'dependency_relation': 'compound', 'origin_pos': 647, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '62', 'text': 'binding', 'governor': 58, 'dependency_relation': 'obj', 'origin_pos': 660, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '63', 'text': 'of', 'governor': 66, 'dependency_relation': 'case', 'origin_pos': 668, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '64', 'text': '[', 'governor': 66, 'dependency_relation': 'punct', 'origin_pos': 671, 'ner_label': 'B-Chemical', 'code': '-1', 'is_e2': False, 'is_e1': False}, {'inter_index': '65', 'text': '3', 'governor': 66, 'dependency_relation': 'nummod', 'origin_pos': 672, 'ner_label': 'I-Chemical', 'code': '-1', 'is_e2': False, 'is_e1': False}, {'inter_index': '66', 'text': 'h', 'governor': 62, 'dependency_relation': 'nmod', 'origin_pos': 673, 'ner_label': 'I-Chemical', 'code': '-1', 'is_e2': False, 'is_e1': False}, {'inter_index': '67', 'text': ']', 'governor': 66, 'dependency_relation': 'punct', 'origin_pos': 674, 'ner_label': 'I-Chemical', 'code': '-1', 'is_e2': False, 'is_e1': False}, {'inter_index': '68', 'text': '-', 'governor': 62, 'dependency_relation': 'punct', 'origin_pos': 675, 'ner_label': 'I-Chemical', 'code': '-1', 'is_e2': False, 'is_e1': False}, {'inter_index': '69', 'text': 'dihydroergocryptine', 'governor': 62, 'dependency_relation': 'appos', 'origin_pos': 676, 'ner_label': 'I-Chemical', 'code': '-1', 'is_e2': False, 'is_e1': False}, {'inter_index': '70', 'text': '(', 'governor': 72, 'dependency_relation': 'punct', 'origin_pos': 696, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '71', 'text': '1', 'governor': 72, 'dependency_relation': 'nummod', 'origin_pos': 697, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '72', 'text': 'nm', 'governor': 69, 'dependency_relation': 'appos', 'origin_pos': 699, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '73', 'text': ')', 'governor': 72, 'dependency_relation': 'punct', 'origin_pos': 701, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '74', 'text': '.', 'governor': 58, 'dependency_relation': 'punct', 'origin_pos': 702, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}], [{'inter_index': '1', 'text': 'these', 'governor': 2, 'dependency_relation': 'det', 'origin_pos': 704, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '2', 'text': 'findings', 'governor': 3, 'dependency_relation': 'nsubj', 'origin_pos': 710, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '3', 'text': 'indicate', 'governor': 0, 'dependency_relation': 'root', 'origin_pos': 719, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '4', 'text': 'that', 'governor': 15, 'dependency_relation': 'mark', 'origin_pos': 728, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '5', 'text': 'in', 'governor': 8, 'dependency_relation': 'case', 'origin_pos': 733, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '6', 'text': 'spontaneously', 'governor': 7, 'dependency_relation': 'advmod', 'origin_pos': 736, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '7', 'text': 'hypertensive', 'governor': 8, 'dependency_relation': 'amod', 'origin_pos': 750, 'ner_label': 'B-Disease', 'code': 'D006973', 'is_e2': False, 'is_e1': False}, {'inter_index': '8', 'text': 'rats', 'governor': 15, 'dependency_relation': 'obl', 'origin_pos': 763, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '9', 'text': 'the', 'governor': 10, 'dependency_relation': 'det', 'origin_pos': 768, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '10', 'text': 'effects', 'governor': 15, 'dependency_relation': 'nsubj', 'origin_pos': 772, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '11', 'text': 'of', 'governor': 14, 'dependency_relation': 'case', 'origin_pos': 780, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '12', 'text': 'central', 'governor': 14, 'dependency_relation': 'amod', 'origin_pos': 783, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '13', 'text': 'alpha-adrenoceptor', 'governor': 14, 'dependency_relation': 'amod', 'origin_pos': 791, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '14', 'text': 'stimulation', 'governor': 10, 'dependency_relation': 'nmod', 'origin_pos': 810, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '15', 'text': 'involve', 'governor': 3, 'dependency_relation': 'ccomp', 'origin_pos': 822, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '16', 'text': 'activation', 'governor': 15, 'dependency_relation': 'obj', 'origin_pos': 830, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '17', 'text': 'of', 'governor': 19, 'dependency_relation': 'case', 'origin_pos': 841, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '18', 'text': 'opiate', 'governor': 19, 'dependency_relation': 'amod', 'origin_pos': 844, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '19', 'text': 'receptors', 'governor': 16, 'dependency_relation': 'nmod', 'origin_pos': 851, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '20', 'text': '.', 'governor': 3, 'dependency_relation': 'punct', 'origin_pos': 860, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}], [{'inter_index': '1', 'text': 'as', 'governor': 7, 'dependency_relation': 'mark', 'origin_pos': 862, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '2', 'text': 'naloxone', 'governor': 7, 'dependency_relation': 'nsubj', 'origin_pos': 865, 'ner_label': 'B-Chemical', 'code': 'D009270', 'is_e2': False, 'is_e1': False}, {'inter_index': '3', 'text': 'and', 'governor': 4, 'dependency_relation': 'cc', 'origin_pos': 874, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '4', 'text': 'clonidine', 'governor': 2, 'dependency_relation': 'conj', 'origin_pos': 878, 'ner_label': 'B-Chemical', 'code': 'D003000', 'is_e2': False, 'is_e1': False}, {'inter_index': '5', 'text': 'do', 'governor': 7, 'dependency_relation': 'aux', 'origin_pos': 888, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '6', 'text': 'not', 'governor': 7, 'dependency_relation': 'advmod', 'origin_pos': 891, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '7', 'text': 'appear', 'governor': 20, 'dependency_relation': 'advcl', 'origin_pos': 895, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '8', 'text': 'to', 'governor': 9, 'dependency_relation': 'mark', 'origin_pos': 902, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '9', 'text': 'interact', 'governor': 7, 'dependency_relation': 'xcomp', 'origin_pos': 905, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '10', 'text': 'with', 'governor': 14, 'dependency_relation': 'case', 'origin_pos': 914, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '11', 'text': 'the', 'governor': 14, 'dependency_relation': 'det', 'origin_pos': 919, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '12', 'text': 'same', 'governor': 14, 'dependency_relation': 'amod', 'origin_pos': 923, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '13', 'text': 'receptor', 'governor': 14, 'dependency_relation': 'compound', 'origin_pos': 928, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '14', 'text': 'site', 'governor': 9, 'dependency_relation': 'obl', 'origin_pos': 937, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '15', 'text': ',', 'governor': 20, 'dependency_relation': 'punct', 'origin_pos': 941, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '16', 'text': 'the', 'governor': 19, 'dependency_relation': 'det', 'origin_pos': 943, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '17', 'text': 'observed', 'governor': 19, 'dependency_relation': 'amod', 'origin_pos': 947, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '18', 'text': 'functional', 'governor': 19, 'dependency_relation': 'amod', 'origin_pos': 956, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '19', 'text': 'antagonism', 'governor': 20, 'dependency_relation': 'nsubj', 'origin_pos': 967, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '20', 'text': 'suggests', 'governor': 0, 'dependency_relation': 'root', 'origin_pos': 978, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '21', 'text': 'the', 'governor': 22, 'dependency_relation': 'det', 'origin_pos': 987, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '22', 'text': 'release', 'governor': 20, 'dependency_relation': 'obj', 'origin_pos': 991, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '23', 'text': 'of', 'governor': 26, 'dependency_relation': 'case', 'origin_pos': 999, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '24', 'text': 'an', 'governor': 26, 'dependency_relation': 'det', 'origin_pos': 1002, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '25', 'text': 'endogenous', 'governor': 26, 'dependency_relation': 'amod', 'origin_pos': 1005, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '26', 'text': 'opiate', 'governor': 22, 'dependency_relation': 'nmod', 'origin_pos': 1016, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '27', 'text': 'by', 'governor': 28, 'dependency_relation': 'case', 'origin_pos': 1023, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '28', 'text': 'clonidine', 'governor': 26, 'dependency_relation': 'nmod', 'origin_pos': 1026, 'ner_label': 'B-Chemical', 'code': 'D003000', 'is_e2': False, 'is_e1': False}, {'inter_index': '29', 'text': 'or', 'governor': 30, 'dependency_relation': 'cc', 'origin_pos': 1036, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '30', 'text': 'alpha-methyldopa', 'governor': 28, 'dependency_relation': 'conj', 'origin_pos': 1039, 'ner_label': 'B-Chemical', 'code': 'D008750', 'is_e1': True, 'is_e2': False}, {'inter_index': '31', 'text': 'and', 'governor': 34, 'dependency_relation': 'cc', 'origin_pos': 1056, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '32', 'text': 'the', 'governor': 34, 'dependency_relation': 'det', 'origin_pos': 1060, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '33', 'text': 'possible', 'governor': 34, 'dependency_relation': 'amod', 'origin_pos': 1064, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '34', 'text': 'role', 'governor': 28, 'dependency_relation': 'conj', 'origin_pos': 1073, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '35', 'text': 'of', 'governor': 37, 'dependency_relation': 'case', 'origin_pos': 1078, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '36', 'text': 'the', 'governor': 37, 'dependency_relation': 'det', 'origin_pos': 1081, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '37', 'text': 'opiate', 'governor': 34, 'dependency_relation': 'nmod', 'origin_pos': 1085, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '38', 'text': 'in', 'governor': 41, 'dependency_relation': 'case', 'origin_pos': 1092, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '39', 'text': 'the', 'governor': 41, 'dependency_relation': 'det', 'origin_pos': 1095, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '40', 'text': 'central', 'governor': 41, 'dependency_relation': 'amod', 'origin_pos': 1099, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '41', 'text': 'control', 'governor': 34, 'dependency_relation': 'nmod', 'origin_pos': 1107, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '42', 'text': 'of', 'governor': 44, 'dependency_relation': 'case', 'origin_pos': 1115, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '43', 'text': 'sympathetic', 'governor': 44, 'dependency_relation': 'amod', 'origin_pos': 1118, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '44', 'text': 'tone', 'governor': 41, 'dependency_relation': 'nmod', 'origin_pos': 1130, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}, {'inter_index': '45', 'text': '.', 'governor': 20, 'dependency_relation': 'punct', 'origin_pos': 1134, 'ner_label': 'Other', 'code': 'nan', 'is_e2': False, 'is_e1': False}]]
    def parse_sample(self, sample):
        x = []
        masked_entities_encoded_seqs = []
        chemical_code_seqs = [1]
        disease_code_seqs = [2]
        label = [0]
        return x, masked_entities_encoded_seqs, chemical_code_seqs, disease_code_seqs, label

    def __len__(self, ):
        return len(self.samples)

    def __getitem__(self, idx):
        sample = self.samples[idx]
        tokens, masked_entities_encoded_seqs, chemical_code_seqs, disease_code_seqs, label = self.parse_sample(sample)
        output = [torch.LongTensor(tokens), torch.LongTensor(masked_entities_encoded_seqs),
                  torch.tensor(chemical_code_seqs), torch.tensor(disease_code_seqs), torch.tensor(label)]
        return output


def process_sample(sample, tokenizer):
    x = []
    masked_entities_encoded_seqs = []
    chemical_code_seqs = 1
    disease_code_seqs = 2
    tokens = sample['token']
    subj_start = sample['subj_start']
    subj_end = sample['subj_end']
    obj_start = sample['obj_start']
    obj_end = sample['obj_end']
    label = sample['relation']
    if subj_start < obj_start:
        first_start, first_end = subj_start, subj_end
        first_mask = S_MASK
        sec_start, sec_end = obj_start, obj_end
        sec_mask = O_MASK
    else:
        first_start, first_end = obj_start, obj_end
        first_mask = O_MASK
        sec_start, sec_end = subj_start, subj_end
        sec_mask = S_MASK
    prior = ' '.join(tokens[: first_start])
    first_mention = ' '.join(tokens[first_start: first_end])
    midle = ' '.join(tokens[first_end:sec_start])
    sec_mention = ' '.join(tokens[sec_start:sec_end])
    post = ' '.join(tokens[sec_end:])
    x.extend(tokenizer.tokenize(prior))
    masked_entities_encoded_seqs.extend([0] * len(x))
    x.append('[E]')
    x.extend(tokenizer.tokenize(first_mention))
    x.append('[/E]')
    masked_entities_encoded_seqs.extend([first_mask] * (len(x) - len(masked_entities_encoded_seqs)))
    x.extend(tokenizer.tokenize(midle))
    masked_entities_encoded_seqs.extend([0] * (len(x) - len(masked_entities_encoded_seqs)))
    x.append('[E]')
    x.extend(tokenizer.tokenize(sec_mention))
    x.append('[/E]')
    masked_entities_encoded_seqs.extend([sec_mask] * (len(x) - len(masked_entities_encoded_seqs)))
    x.extend(tokenizer.tokenize(post))
    masked_entities_encoded_seqs.extend([0] * (len(x) - len(masked_entities_encoded_seqs)))
    masked_entities_encoded_seqs = [0] + masked_entities_encoded_seqs + [0]
    x = tokenizer.encode(x)
    assert len(x) == len(masked_entities_encoded_seqs)
    return {'x': x, 'masked_entities_encoded_seqs': masked_entities_encoded_seqs,
            'chemical_code_seqs': chemical_code_seqs, 'disease_code_seqs': disease_code_seqs, 'label': label}


def read_tacred_data(data_file, label_dict_file):
    with open(data_file, 'r') as f:
        samples = json.load(f)
    print("len sample: ", len(samples))
    from utils.trainer_utils import get_tokenizer
    tokenizer = get_tokenizer()
    data = []
    for sample in samples:
        a_sample = process_sample(sample, tokenizer)
        data.append(a_sample)
    if os.path.isfile(label_dict_file):
        with open(label_dict_file, 'r') as f:
            label_dict = json.load(f)
    else:
        all_labels = list(set([sample['label'] for sample in data]))
        print("all_labels: ", all_labels)
        label_dict = {all_labels[i]: i for i in range(len(all_labels))}
        with open(label_dict_file, 'w') as f:
            json.dump(label_dict, f)
    return data, label_dict


if __name__ == '__main__':
    data_file = 'D:\\relation_extraction_cdr\\data\\tacred\\train.json'
    label_dict_file = 'D:\\relation_extraction_cdr\\models_saved/label_dict.json'
    data, label_dict = read_tacred_data(data_file, label_dict_file)
    print("data 0: ", data[0])
    print("len data: ", len(data))
    print("label_dict: ", label_dict)
